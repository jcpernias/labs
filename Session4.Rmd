---
title: "Cuarta sesión de laboratorio"
author: "José C. Pernías"
date: "15/03/2015"
---

```{r, include=FALSE}
knitr::opts_chunk$set(fig.align='center', echo = FALSE)

library(MASS)

source("labdata.R")

library(ggplot2)
library(knitr)


lab01 <- readSubjectsTables("LA01.xls")
lab02 <- readSubjectsTables("LA02.xls")
lab03 <- readSubjectsTables("LA03.xls")
lab16 <- readSubjectsTables("LA16.xls")
lab17 <- readSubjectsTables("LA17.xls")
lab18 <- readSubjectsTables("LA18.xls")

Bt1 <- rbind.fill (lab01$T1, lab02$T2, lab03$T2, lab16$T1, lab17$T1, lab18$T1)
Bt2 <- rbind.fill (lab01$T2, lab02$T3, lab03$T3, lab16$T2, lab17$T2, lab18$T2)
Bt3 <- rbind.fill (lab01$T3, lab02$T4, lab03$T1, lab16$T3, lab17$T3, lab18$T3)

Bt1 <- Bt1 %>% mutate(Period = as.factor(Period))
Bt2 <- Bt2 %>% mutate(Period = as.factor(Period))
Bt3 <- Bt3 %>% mutate(Period = as.factor(Period))

Bt2_lo <- Bt2 %>% filter(pmin == 200)
Bt3_lo <- Bt3 %>% filter(pmin == 200)
Bt2_hi <- Bt2 %>% filter(pmin != 200)
Bt3_hi <- Bt3 %>% filter(pmin != 200)

```

## Tratamiento 1

* Dos empresas sirven el mercado de un producto homogéneo.
* El coste de producción unitario de las dos empresas es de\ \(200\ €\).
* Cada empresa decide simultáneamente a qué precio vende su producción.

## Costes

- El coste unitario es independiente de la producción:
  \[
    CMe_1(q_1) = 200; \qquad CMe_2(q_2) = 200 
  \]

- Los costes de cada una de las empresas son:
  \[
    C_1(q_1) = 200 q_1; \qquad C_2(q_2) = 200 q_2
  \]

- El coste marginal coincide con el coste unitario:
  \[
    CMg_1(q_1) == 200; \qquad CMg_2(q_2) = 200
  \]


## Demanda

- La curva de demanda del mercado es:
  \[
     Q = 1000 -  2 P
  \]

- La empresa que fija el mayor precio no vende nada.
- Si las dos empresas fijan el mismo precio las ventas se reparten a partes iguales.

## Demanda de la empresa
- La curva de demanda de la empresa 1 es:
  \[
  q_1 = \begin{cases} 0 & \text{si $p_1 > p_2$} \\ 500 - p_1 & \text{si $p_1 = p_2$} \\
    1000 - 2 p_1 & \text{si $p_1 < p_2$}
  \end{cases}
  \]

- La curva de demanda de la empresa 2 es:
  \[
  q_2 = \begin{cases} 1000 - 2 p_1 & \text{si $p_1 > p_2$} \\ 500 - p_1 & \text{si $p_1 = p_2$} \\
  0   & \text{si $p_1 < p_2$}
  \end{cases}
  \]

## Equilibrio

- Equilibrio de Nash: cada empresa obtiene los mejores resultados posibles, dadas las estrategias que han seleccionado sus rivales.

- En equilibrio, los precios fijados por las empresas son iguales: $p^*_1 = p^*_2$.
- Cuando los precios no son continuos, existen dos equilibrios de Nash:
  \[
  \begin{gather*}
    p^*_1 = p^*_2 = 200 \\
    p^*_1 = p^*_2 = 201
  \end{gather*}
  \]
  
 
## Resultados del laboratorio

- Sesiones del 2 de marzo (grupo F) y 3 de marzo (grupo A) de 2015.
- Cada tratamiento estaba compuesto por 7 periodos.
- Número de sujetos: `r NROW(Bt1)/7`.

## Estadísticos descriptivos
### Precios


```{r}

kable(ddply (Bt1, .(Period), summTable, "precio"),
  digits = 1)      

```



## Distribución de los precios

```{r}

ggplot(Bt1, aes(Period, precio)) + 
  geom_boxplot(fill="orange", alpha = 0.3) +
  geom_hline(yintercept = 200, color = "DarkGreen", size = 1, alpha = 0.5) +
  ylab("p") 

```




## Tratamiento 2

* Dos empresas sirven el mercado de un producto homogéneo.
* El coste de producción unitario de la empresa 1 es de\ \(200\ €\).
* El coste de producción unitario de la empresa 2 es de\ \(290\ €\).
* Cada empresa decide simultáneamente a qué precio vende su producción.

## Costes

- El coste unitario es independiente de la producción:
  \[
    CMe_1(q_1) = 200; \qquad CMe_2(q_2) = 290 
  \]

- Los costes de cada una de las empresas son:
  \[
    C_1(q_1) = 200 q_1; \qquad C_2(q_2) = 290 q_2
  \]

- El coste marginal coincide con el coste unitario:
  \[
    CMg_1(q_1) = 200; \qquad  CMg_2(q_2) = 290
  \]

## Equilibrio

- La empresa con ventaja de costes puede quedarse con todo el mercado fijando un precio ligeramente inferior al coste unitario de su rival:
  \[
  p^*_1 = 289 
  \]
- La empresa 2 no puede fijar un precio inferior a su coste medio:
  \[
  p^*_2 = 291
  \]



## Estadísticos descriptivos
### Precios de la empresa con costes bajos


```{r}

kable(ddply (Bt2_lo, .(Period), summTable, "precio"),
  digits = 1)      

```


## Estadísticos descriptivos
### Precios de la empresa con costes altos


```{r}

kable(ddply (Bt2_hi, .(Period), summTable, "precio"),
  digits = 1)      

```



## Distribución de los precios
### Empresa con costes bajos

```{r}

ggplot(Bt2_lo, aes(Period, precio)) + 
  geom_boxplot(fill="orange", alpha = 0.3) +
  geom_hline(yintercept = 289, color = "DarkGreen", size = 1, alpha = 0.5) +
  ylab(expression(p[1])) 

```

## Distribución de los precios
### Empresa con costes altos

```{r}

ggplot(Bt2_hi, aes(Period, precio)) + 
  geom_boxplot(fill="orange", alpha = 0.3) +
  geom_hline(yintercept = 291, color = "DarkGreen", size = 1, alpha = 0.5) +
  ylim(200, 500) + ylab(expression(p[2])) 

```

## Tratamiento 3

* Dos empresas sirven el mercado de un producto homogéneo.
* El coste de producción unitario de la empresa 1 es de\ \(200\ €\).
* El coste de producción unitario de la empresa 2 es de\ \(400\ €\).
* Cada empresa decide simultáneamente a qué precio vende su producción.

## Costes

- El coste unitario es independiente de la producción:
  \[
    CMe_1(q_1) = 200; \qquad CMe_2(q_2) = 400
  \]

- Los costes de cada una de las empresas son:
  \[
    C_1(q_1) = 200 q_1; \qquad C_2(q_2) = 400 q_2
  \]

- El coste marginal coincide con el coste unitario:
  \[
    CMg_1(q_1) = 200; \qquad  CMg_2(q_2) = 400
  \]

## Equilibrio

- En este caso la diferencia de costes es tan grande que permite a la empresa con ventaja de costes puede quedarse con todo el mercado fijando el precio de monopolio:
  \[
  p^*_1 = 350
  \]
- La empresa 2 no puede fijar un precio inferior a su coste medio:
  \[
  p^*_2 = 401
  \]


## Estadísticos descriptivos
### Precios de la empresa con costes bajos


```{r}

kable(ddply (Bt3_lo, .(Period), summTable, "precio"),
  digits = 1)      

```


## Estadísticos descriptivos
### Precios de la empresa con costes altos


```{r}

kable(ddply (Bt3_hi, .(Period), summTable, "precio"),
  digits = 1)      

```



## Distribución de los precios
### Empresa con costes bajos

```{r}

ggplot(Bt3_lo, aes(Period, precio)) + 
  geom_boxplot(fill="orange", alpha = 0.3) +
  geom_hline(yintercept = 350, color = "DarkGreen", size = 1, alpha = 0.5) +
  ylab(expression(p[1])) 

```

## Distribución de la precios
### Empresa con costes altos

```{r}

ggplot(Bt3_hi, aes(Period, precio)) + 
  geom_boxplot(fill="orange", alpha = 0.3) +
  geom_hline(yintercept = 401, color = "DarkGreen", size = 1, alpha = 0.5) +
  ylim(200, 500) + ylab(expression(p[2])) 

```
